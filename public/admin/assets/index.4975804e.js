var ee=Object.defineProperty,oe=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var R=(s,u,o)=>u in s?ee(s,u,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[u]=o,F=(s,u)=>{for(var o in u||(u={}))ne.call(u,o)&&R(s,o,u[o]);if(E)for(var o of E(u))te.call(u,o)&&R(s,o,u[o]);return s},w=(s,u)=>oe(s,ue(u));var D=(s,u,o)=>new Promise((y,g)=>{var f=a=>{try{c(o.next(a))}catch(n){g(n)}},i=a=>{try{c(o.throw(a))}catch(n){g(n)}},c=a=>a.done?y(a.value):Promise.resolve(a.value).then(f,i);c((o=o.apply(s,u)).next())});import{D as se,T as ae,B as le}from"./TableAction.ddf2d302.js";import{u as P,B as x}from"./useForm.a669a7ea.js";import{d as ie,g as re,u as T,c as ce}from"./plugin_templates.356d7705.js";import{c as de,f as fe,a as me}from"./columns.0bcb0616.js";import{P as pe}from"./PlusOutlined.d17bf5b7.js";import{d as _e,u as ge,bb as Fe,r as v,s as A,v as C,a4 as S,N as ve,e as Be,x as he,w as t,h as l,i as d,j as h,y as ye,z as we,l as De,D as Ce,E as be,n as ke}from"./index.e68eab72.js";import"./sortable.esm.bd95be41.js";import"./useDesignSetting.b2231b13.js";import"./index.esm.dae7b788.js";import"./DownOutlined.4f60e279.js";import"./list.1ea473c3.js";const Ee={name:"PluginList"},Me=_e(w(F({},Ee),{setup(s){const u=[{field:"keywords",labelMessage:"\u652F\u6301\u6807\u9898\u3001\u522B\u540D\u8DEF\u7531\u3001\u7C7B\u540D\u7B49\u641C\u7D22",component:"NInput",label:"\u641C\u7D22\u5173\u952E\u5B57",componentProps:{placeholder:"\u8BF7\u8F93\u5165\u9700\u8981\u641C\u7D22\u5173\u952E\u5B57",onInput:e=>{n.title=e,n.alias=e,n.class=e}}}],o=ge(),y=Fe(),g=v(null),f=v(),i=v(!1),c=v(!1),a=v(!0),n=A({pageSize:10,column:"id",order:"desc",title:"",alias:"",class:""}),N=A({width:220,title:"\u64CD\u4F5C",key:"action",fixed:"right",render(e){return C(ae,{style:"button",actions:[{label:"\u7F16\u8F91",type:"primary",onClick:q.bind(null,e),ifShow:()=>!0},{label:"\u5378\u8F7D",icon:se,type:"error",onClick:G.bind(null,e),ifShow:()=>!0}]})}}),[U,{}]=P({gridProps:{cols:1},labelWidth:150,schemas:u,showAdvancedButton:!1}),[V,{getFieldsValue:b,setFieldsValue:I,setProps:O}]=P({gridProps:{cols:"1",collapsedRows:100},labelWidth:150,schemas:me,showAdvancedButton:!1,showActionButtonGroup:!1});function L(){i.value=!0,a.value=!0,S(()=>{O({schemas:fe})})}const M=e=>D(this,null,function*(){return yield re(F(F({},n),e))});function z({record:e,key:r,value:p}){T({id:e.id,[r]:p}).then(()=>{o.success("\u66F4\u65B0\u6210\u529F"),m()})}function K(e){console.log(e)}function m(){console.log(f),f.value.reload()}function W(e){console.log(b()),e.preventDefault(),c.value=!0;try{g.value.formElRef.validate(r=>D(this,null,function*(){if(r)o.error("\u8BF7\u586B\u5199\u5B8C\u6574\u4FE1\u606F");else{const p=b();a.value?(yield ce(p),o.success("\u6DFB\u52A0\u6210\u529F")):(yield T(p),o.success("\u66F4\u65B0\u6210\u529F")),i.value=!1,m()}}))}finally{c.value=!1}}function q(e){console.log("\u70B9\u51FB\u4E86\u7F16\u8F91",e),a.value=!1,i.value=!0,S(()=>{I(w(F({},e),{config:JSON.stringify(e.config,null,4)}))})}function G(e){y.warning({title:"\u8B66\u544A",content:()=>C("div",["\u60A8\u786E\u5B9A\u8981\u5378\u8F7D ",C(ve,{type:"info"},e.title)," \u5417\uFF1F"]),positiveText:"\u786E\u8BA4",negativeText:"\u53D6\u6D88",onPositiveClick:()=>{ie({id:e.id}).then(()=>{o.success("\u5378\u8F7D\u6210\u529F"),m()})},onClose:()=>{}})}function J(e){console.log(e),f.value.updatePage(1),m()}function H(e){console.log(e),n.title="",n.class="",n.alias=""}function Q(e){console.log(e),e.order?[n.column,n.order]=[e.columnKey,e.order.slice(0,e.order.lastIndexOf("end"))]:[n.column,n.order]=["",""],m()}return(e,r)=>{const p=ye,X=we,B=De,Y=Ce,Z=be,$=ke;return Be(),he($,{bordered:!1},{default:t(()=>[l(d(x),{onRegister:d(U),onSubmit:J,onReset:H},{statusSlot:t(({model:_,field:k})=>[l(p,{value:_[k],"onUpdate:value":j=>_[k]=j},null,8,["value","onUpdate:value"])]),_:1},8,["onRegister"]),l(d(le),{columns:d(de),request:M,"row-key":_=>_.id,ref_key:"actionRef",ref:f,actionColumn:N,"onUpdate:checkedRowKeys":K,"scroll-x":3e3,onEditEnd:z,"onUpdate:sorter":Q},{tableTitle:t(()=>[l(B,{type:"primary",onClick:L},{icon:t(()=>[l(X,null,{default:t(()=>[l(d(pe))]),_:1})]),default:t(()=>[h(" \u65B0\u589E ")]),_:1})]),toolbar:t(()=>[l(B,{type:"primary",onClick:m},{default:t(()=>[h("\u5237\u65B0\u6570\u636E")]),_:1})]),_:1},8,["columns","row-key","actionColumn"]),l(Z,{show:i.value,"onUpdate:show":r[1]||(r[1]=_=>i.value=_),"show-icon":!1,preset:"dialog",title:a.value?"\u65B0\u589E":"\u7F16\u8F91"},{action:t(()=>[l(Y,null,{default:t(()=>[l(B,{onClick:r[0]||(r[0]=()=>i.value=!1)},{default:t(()=>[h("\u53D6\u6D88")]),_:1}),l(B,{type:"info",loading:c.value,onClick:W},{default:t(()=>[h("\u786E\u5B9A")]),_:1},8,["loading"])]),_:1})]),default:t(()=>[l(d(x),{ref_key:"formRef",ref:g,onRegister:d(V)},null,8,["onRegister"])]),_:1},8,["show","title"])]),_:1})}}}));export{Me as default};
